---
layout: default
title: Certified Lover Data
---

<!-- Slide indicator bar -->
<div class="nav-indicator">
  <span class="bar" id="bar0"></span>
  <span class="bar" id="bar1"></span>
  <span class="bar" id="bar2"></span>
  <span class="bar" id="bar3"></span>
  <span class="bar" id="bar4"></span>
  <span class="bar" id="bar5"></span>
</div>

<!-- Slide container -->
<div class="slider-container">
  <section class="slide" id="slide1">
    <img src="{{ site.baseurl }}/assets/images/logo.png" alt="Certified Lover Data" class="logo" />
    <img src="{{ site.baseurl }}/assets/images/party2.gif" alt="Party GIF" class="party-gif" />
  </section>

  <section class="slide" id="slide2">
    <img src="{{ site.baseurl }}/assets/images/genre-race-title.png" alt="Genre Race Chart" class="genre-race-title" />
    <div class="chart-container">
      <img src="{{ site.baseurl }}/assets/images/genre-race.png" alt="Genre Race Chart" class="chart-img" />
    </div>
  </section>

  <section class="slide" id="slide3">
    <img src="{{ site.baseurl }}/assets/images/Map.png" alt="Map" class="map" />
    <div class="map-container">
      <svg id="my_dataviz" width="1500" height="750"></svg>
    </div>
  </section>

  <section class="slide" id="slide4">
    <img src="{{ site.baseurl }}/assets/images/correlations.png" alt="correlations" class="correlations" />
    <div class="chart-container">
      <img src="{{ site.baseurl }}/assets/images/correlation-map.png" alt="correlation-map" class="correlation-map" />
    </div>
  </section>

  <section class="slide" id="slide5">
    <img src="{{ site.baseurl }}/assets/images/genre-popularity.png" alt="popularity" class="popularity" />
    <div class="chart-container">
      <img src="{{ site.baseurl }}/assets/images/features.png" alt="popularity-map" class="popularity-map" />
    </div>
  </section>

  <section class="slide" id="slide6">
    <img src="{{ site.baseurl }}/assets/images/genrify-title.png" alt="genrify-title" class="genrify-title" />
    <img src="{{ site.baseurl }}/assets/images/genrify-subtitle.png" alt="genrify-subtitle" class="genrify-subtitle" />
    <div class="chart-container">
      <img src="{{ site.baseurl }}/assets/images/genrify.png" alt="genrify-map" class="genrify-map" />
    </div>
  </section>
</div>

<!-- Navigation arrows using images -->
<div class="nav-arrow left" id="leftArrow" onclick="prevSlide()">
  <img src="{{ site.baseurl }}/assets/images/left.png" alt="Left arrow" class="arrow-img" />
</div>

<div class="nav-arrow right" id="rightArrow" onclick="nextSlide()">
  <img src="{{ site.baseurl }}/assets/images/right.png" alt="Right arrow" class="arrow-img" />
</div>

<!-- Click prompt image (outside the arrow to avoid click propagation) -->
<img src="{{ site.baseurl }}/assets/images/click.png" alt="Click prompt" class="click-prompt" id="clickPrompt" />

<!-- JavaScript logic -->
<script>
  let currentSlide = 0;
  const totalSlides = 6;

  function nextSlide() {
    if (currentSlide < totalSlides - 1) {
      currentSlide++;
      updateSlide();
    }
  }

  function prevSlide() {
    if (currentSlide > 0) {
      currentSlide--;
      updateSlide();
    }
  }

  function drawMap() {
  const svg = d3.select("#my_dataviz"),
        width = +svg.attr("width"),
        height = +svg.attr("height");

  const projection = d3.geoNaturalEarth1()
    .scale(260)
    .translate([width / 2, height / 2]);

  const path = d3.geoPath().projection(projection);

  const tooltip = d3.select("body")
    .append("div")
    .attr("class", "tooltip")
    .style("position", "absolute")
    .style("padding", "8px")
    .style("background", "white")
    .style("border", "1px solid #ccc")
    .style("border-radius", "5px")
    .style("font-size", "14px")
    .style("pointer-events", "none")
    .style("display", "none");

  const countryNameFixes = {
    "USA": "United States",
    "UK": "United Kingdom",
    "Russia": "Russian Federation",
    "South Korea": "Republic of Korea",
    "North Korea": "Dem. Rep. Korea",
    "Vietnam": "Viet Nam",
    "Czechia": "Czech Republic",
    "Ivory Coast": "C√¥te d'Ivoire",
    "Venezuela": "Venezuela (Bolivarian Republic of)",
    "Tanzania": "United Republic of Tanzania"
  };

  d3.queue()
    .defer(d3.json, "https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson")
    .defer(d3.csv, "{{ site.baseurl }}/assets/data/top_genre_and_audio_stats_per_country.csv")
    .await(function(error, geoData, csvData) {
      if (error) throw error;

      const countryInfo = {};
      csvData.forEach(d => {
        const fixedName = countryNameFixes[d.country_name] || d.country_name;
        countryInfo[fixedName] = {
          genre: d.spotify_genre,
          dance: (+d.avg_danceability).toFixed(2),
          energy: (+d.avg_energy).toFixed(2),
          valence: (+d.avg_valence).toFixed(2),
          tempo: (+d.avg_tempo).toFixed(0),
          popularity: (+d.avg_popularity).toFixed(0)
        };
      });

      svg.append("g")
        .selectAll("path")
        .data(geoData.features)
        .enter()
        .append("path")
          .attr("d", path)
          .attr("fill", d => countryInfo[d.properties.name] ? "#69b3a2" : "#e0e0e0")
          .style("stroke", "#fff")
          .on("mouseover", function(d) {
            const info = countryInfo[d.properties.name];
            if (!info) return;

            d3.select(this)
              .transition().duration(200)
              .attr("fill", "#ff6f61");

            tooltip
              .style("display", "block")
              .html(
                `<strong>${d.properties.name}</strong><br>` +
                `üéß Genre: ${info.genre}<br>` +
                `üíÉ Danceability: ${info.dance}<br>` +
                `‚ö°Ô∏è Energy: ${info.energy}<br>` +
                `üòä Valence: ${info.valence}<br>` +
                `üéµ Tempo: ${info.tempo} BPM<br>` +
                `üî• Popularity: ${info.popularity}`
              );
          })
          .on("mousemove", function() {
            tooltip
              .style("left", (d3.event.pageX + 10) + "px")
              .style("top", (d3.event.pageY - 28) + "px");
          })
          .on("mouseout", function(d) {
            const hasData = countryInfo[d.properties.name];
            d3.select(this)
              .transition().duration(200)
              .attr("fill", hasData ? "#69b3a2" : "#e0e0e0");

            tooltip.style("display", "none");
          });
    });
}


  function updateSlide() {
    const container = document.querySelector('.slider-container');
    container.style.transform = `translateX(-${currentSlide * 100}vw)`;

    document.getElementById('leftArrow').style.display = currentSlide === 0 ? 'none' : 'block';
    document.getElementById('rightArrow').style.display = currentSlide === totalSlides - 1 ? 'none' : 'block';

    const bars = document.querySelectorAll('.nav-indicator .bar');
    bars.forEach((bar, index) => {
      bar.classList.toggle('active', index === currentSlide);
    });

    const clickPrompt = document.getElementById("clickPrompt");
    if (clickPrompt) {
      clickPrompt.style.display = currentSlide === 0 ? "block" : "none";
    }

    if (currentSlide === 2 && !window.mapDrawn) {
      drawMap();
      window.mapDrawn = true;
    }
  }

  document.addEventListener("DOMContentLoaded", updateSlide);
</script>
